> #############################
> ### Latent Variable Model ###
> #############################
> # Read data
> chap13Data <- read.table("Chap13_Exp1.txt", quote = "\"", comment.char = "")
> sd <- as.matrix(chap13Data[1,])
> cor <- as.matrix(chap13Data[-1,])
> cov <- cor * matrix(outer(sd, sd), nrow = 9, byrow = TRUE)   
> colnames(cov) <- rownames(cov) <- c("coach1", "coach2", "coach3", 
+                                     "severe1", "severe2", "severe3", 
+                                     "intent1", "intent2", "intent3")
> 
> # Load package
> library(lavaan)
> 
> # Model syntax
> chap13Model <- '
+ coach =~ coach1 + coach2 + coach3
+ severe =~ severe1 + severe2 + severe3
+ intent =~ intent1 + intent2 + intent3
+ intent ~ severe + coach
+ severe ~ coach
+ '
> 
> chap13Fit <- sem(model = chap13Model, 
+                  sample.cov = cov, 
+                  sample.nobs = 547, 
+                  estimator = "ML")
> summary(chap13Fit, 
+         ci = TRUE,
+         standardized = TRUE)
lavaan 0.6-19 ended normally after 41 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           547

Model Test User Model:
                                                      
  Test statistic                                29.165
  Degrees of freedom                                24
  P-value (Chi-square)                           0.214

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(>|z|) ci.lower ci.upper   Std.lv  Std.all
  coach =~                                                                                
    coach1            1.000                               1.000    1.000    0.688    0.356
    coach2            1.746    0.251    6.962    0.000    1.254    2.237    1.201    0.784
    coach3            1.482    0.213    6.942    0.000    1.064    1.900    1.020    0.789
  severe =~                                                                               
    severe1           1.000                               1.000    1.000    0.986    0.685
    severe2           1.175    0.077   15.310    0.000    1.025    1.326    1.159    0.781
    severe3           1.269    0.082   15.455    0.000    1.108    1.430    1.251    0.865
  intent =~                                                                               
    intent1           1.000                               1.000    1.000    0.894    0.747
    intent2           1.470    0.069   21.429    0.000    1.335    1.604    1.314    0.941
    intent3           1.499    0.071   20.990    0.000    1.359    1.639    1.340    0.873

Regressions:
                   Estimate  Std.Err  z-value  P(>|z|) ci.lower ci.upper   Std.lv  Std.all
  intent ~                                                                                
    severe            0.266    0.048    5.540    0.000    0.172    0.361    0.294    0.294
    coach             0.001    0.068    0.021    0.984   -0.131    0.134    0.001    0.001
  severe ~                                                                                
    coach            -0.415    0.093   -4.462    0.000   -0.597   -0.232   -0.289   -0.289

Variances:
                   Estimate  Std.Err  z-value  P(>|z|) ci.lower ci.upper   Std.lv  Std.all
   .coach1            3.252    0.205   15.829    0.000    2.850    3.655    3.252    0.873
   .coach2            0.906    0.160    5.655    0.000    0.592    1.220    0.906    0.386
   .coach3            0.632    0.115    5.496    0.000    0.406    0.857    0.632    0.378
   .severe1           1.098    0.081   13.578    0.000    0.940    1.257    1.098    0.531
   .severe2           0.859    0.081   10.651    0.000    0.701    1.017    0.859    0.390
   .severe3           0.528    0.078    6.784    0.000    0.376    0.681    0.528    0.253
   .intent1           0.631    0.044   14.482    0.000    0.546    0.717    0.631    0.441
   .intent2           0.222    0.047    4.764    0.000    0.131    0.313    0.222    0.114
   .intent3           0.560    0.058    9.737    0.000    0.447    0.673    0.560    0.238
    coach             0.473    0.125    3.788    0.000    0.228    0.718    1.000    1.000
   .severe            0.890    0.107    8.294    0.000    0.680    1.101    0.916    0.916
   .intent            0.730    0.074    9.848    0.000    0.585    0.876    0.914    0.914

> fitted(chap13Fit)
$cov
        coach1 coach2 coach3 sever1 sever2 sever3 intnt1 intnt2 intnt3
coach1   3.726                                                        
coach2   0.827  2.349                                                 
coach3   0.702  1.225  1.671                                          
severe1 -0.196 -0.343 -0.291  2.070                                   
severe2 -0.231 -0.403 -0.342  1.142  2.201                            
severe3 -0.249 -0.435 -0.369  1.233  1.449  2.093                     
intent1 -0.052 -0.090 -0.076  0.258  0.304  0.328  1.430              
intent2 -0.076 -0.132 -0.112  0.380  0.447  0.482  1.174  1.948       
intent3 -0.077 -0.135 -0.115  0.387  0.455  0.492  1.198  1.760  2.355

> lavInspect(chap13Fit, 
+            what = "est")
$lambda
        coach severe intent
coach1  1.000  0.000  0.000
coach2  1.746  0.000  0.000
coach3  1.482  0.000  0.000
severe1 0.000  1.000  0.000
severe2 0.000  1.175  0.000
severe3 0.000  1.269  0.000
intent1 0.000  0.000  1.000
intent2 0.000  0.000  1.470
intent3 0.000  0.000  1.499

$theta
        coach1 coach2 coach3 sever1 sever2 sever3 intnt1 intnt2 intnt3
coach1   3.252                                                        
coach2   0.000  0.906                                                 
coach3   0.000  0.000  0.632                                          
severe1  0.000  0.000  0.000  1.098                                   
severe2  0.000  0.000  0.000  0.000  0.859                            
severe3  0.000  0.000  0.000  0.000  0.000  0.528                     
intent1  0.000  0.000  0.000  0.000  0.000  0.000  0.631              
intent2  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.222       
intent3  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.560

$psi
       coach severe intent
coach  0.473              
severe 0.000  0.890       
intent 0.000  0.000  0.730

$beta
        coach severe intent
coach   0.000  0.000      0
severe -0.415  0.000      0
intent  0.001  0.266      0