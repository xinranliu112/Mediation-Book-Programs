data a;
input idpart replicate	study	id	X	R	Y	M	XM	a0	a1	a2	W1;
a0a1=a0*a1;a0a2=a0*a2; a1a2=a1*a2; a0a1a2=a0*a1*a2;
cards;
1	1	8	1	1	1	15.081579	9	9	1	1	1	1
1.1	2	8	1	1	1	15.0766553	9	9	0	1	1	1
1.2	3	8	1	1	1	15.081579	9	9	1	0	1	0.1590173
1.3	4	8	1	1	1	15.0766553	9	9	0	0	1	0.1590173
2	1	8	2	1	7	16.0653569	9	9	1	1	1	1
2.1	2	8	2	1	7	14.6623218	9	9	0	1	1	1
2.2	3	8	2	1	7	16.0653569	9	9	1	0	1	0.1590173
2.3	4	8	2	1	7	14.6623218	9	9	0	0	1	0.1590173
3	1	8	3	0	9	11.9741105	3	0	0	0	0	1
3.1	2	8	3	0	9	12.9547678	3	0	1	0	0	1
3.2	3	8	3	0	9	11.9741105	3	0	0	1	0	0.10237371
3.3	4	8	3	0	9	12.9547678	3	0	1	1	0	0.10237371
4	1	8	4	0	9	13.6741773	7	0	0	0	0	1
4.1	2	8	4	0	9	15.2471112	7	0	1	0	0	1
4.2	3	8	4	0	9	13.6741773	7	0	0	1	0	1.59379783
4.3	4	8	4	0	9	15.2471112	7	0	1	1	0	1.59379783
5	1	8	5	0	8	9.66850361	2	0	0	0	0	1
5.1	2	8	5	0	8	11.0105973	2	0	1	0	0	1
5.2	3	8	5	0	8	9.66850361	2	0	0	1	0	0.05153796
5.3	4	8	5	0	8	11.0105973	2	0	1	1	0	0.05153796
6	1	8	6	0	9	11.1240771	1	0	0	0	0	1
6.1	2	8	6	0	9	11.8085961	1	0	1	0	0	1
6.2	3	8	6	0	9	11.1240771	1	0	0	1	0	0.02594574
6.3	4	8	6	0	9	11.8085961	1	0	1	1	0	0.02594574
7	1	8	7	0	8	13.1861912	7	0	0	0	0	1
7.1	2	8	7	0	8	14.7382563	7	0	1	0	0	1
7.2	3	8	7	0	8	13.1861912	7	0	0	1	0	1.59379783
7.3	4	8	7	0	8	14.7382563	7	0	1	1	0	1.59379783
8	1	8	8	0	9	12.3991272	4	0	0	0	0	1
8.1	2	8	8	0	9	13.5278536	4	0	1	0	0	1
8.2	3	8	8	0	9	12.3991272	4	0	0	1	0	0.20335255
8.3	4	8	8	0	9	13.5278536	4	0	1	1	0	0.20335255
9	1	8	9	0	8	8.96496609	1	0	0	0	0	1
9.1	2	8	9	0	8	10.2650655	1	0	1	0	0	1
9.2	3	8	9	0	8	8.96496609	1	0	0	1	0	0.02594574
9.3	4	8	9	0	8	10.2650655	1	0	1	1	0	0.02594574
10	1	8	10	1	8	14.7382563	7	7	1	1	1	1
10.1	2	8	10	1	8	13.1861912	7	7	0	1	1	1
10.2	3	8	10	1	8	14.7382563	7	7	1	0	1	0.62743215
10.3	4	8	10	1	8	13.1861912	7	7	0	0	1	0.62743215
11	1	8	11	1	5	15.737431	9	9	1	1	1	1
11.1	2	8	11	1	5	14.800433	9	9	0	1	1	1
11.2	3	8	11	1	5	15.737431	9	9	1	0	1	0.1590173
11.3	4	8	11	1	5	14.800433	9	9	0	0	1	0.1590173
12	1	8	12	1	4	14.1381524	8	8	1	1	1	1
12.1	2	8	12	1	4	13.0518677	8	8	0	1	1	1
12.2	3	8	12	1	4	14.1381524	8	8	1	0	1	0.31586795
12.3	4	8	12	1	4	13.0518677	8	8	0	0	1	0.31586795
13	1	8	13	1	8	16.2293199	9	9	1	1	1	1
13.1	2	8	13	1	8	14.5932663	9	9	0	1	1	1
13.2	3	8	13	1	8	16.2293199	9	9	1	0	1	0.1590173
13.3	4	8	13	1	8	14.5932663	9	9	0	0	1	0.1590173
14	1	8	14	1	6	14.8109703	8	8	1	1	1	1
14.1	2	8	14	1	6	13.4707982	8	8	0	1	1	1
14.2	3	8	14	1	6	14.8109703	8	8	1	0	1	0.31586795
14.3	4	8	14	1	6	13.4707982	8	8	0	0	1	0.31586795
15	1	8	15	1	4	14.1381524	8	8	1	1	1	1
15.1	2	8	15	1	4	13.0518677	8	8	0	1	1	1
15.2	3	8	15	1	4	14.1381524	8	8	1	0	1	0.31586795
15.3	4	8	15	1	4	13.0518677	8	8	0	0	1	0.31586795
16	1	8	16	1	3	10.5862204	6	6	1	1	1	1
16.1	2	8	16	1	3	8.65011922	6	6	0	1	1	1
16.2	3	8	16	1	3	10.5862204	6	6	1	0	1	1.24631542
16.3	4	8	16	1	3	8.65011922	6	6	0	0	1	1.24631542
17	1	8	17	1	4	14.1381524	8	8	1	1	1	1
17.1	2	8	17	1	4	13.0518677	8	8	0	1	1	1
17.2	3	8	17	1	4	14.1381524	8	8	1	0	1	0.31586795
17.3	4	8	17	1	4	13.0518677	8	8	0	0	1	0.31586795
18	1	8	18	1	6	15.901394	9	9	1	1	1	1
18.1	2	8	18	1	6	14.7313774	9	9	0	1	1	1
18.2	3	8	18	1	6	15.901394	9	9	1	0	1	0.1590173
18.3	4	8	18	1	6	14.7313774	9	9	0	0	1	0.1590173
19	1	8	19	1	6	15.901394	9	9	1	1	1	1
19.1	2	8	19	1	6	14.7313774	9	9	0	1	1	1
19.2	3	8	19	1	6	15.901394	9	9	1	0	1	0.1590173
19.3	4	8	19	1	6	14.7313774	9	9	0	0	1	0.1590173
20	1	8	20	1	5	11.9488221	6	6	1	1	1	1
20.1	2	8	20	1	5	10.183133	6	6	0	1	1	1
20.2	3	8	20	1	5	11.9488221	6	6	1	0	1	1.24631542
20.3	4	8	20	1	5	10.183133	6	6	0	0	1	1.24631542
21	1	8	21	1	6	15.901394	9	9	1	1	1	1
21.1	2	8	21	1	6	14.7313774	9	9	0	1	1	1
21.2	3	8	21	1	6	15.901394	9	9	1	0	1	0.1590173
21.3	4	8	21	1	6	14.7313774	9	9	0	0	1	0.1590173
22	1	8	22	1	4	15.573468	9	9	1	1	1	1
22.1	2	8	22	1	4	14.8694886	9	9	0	1	1	1
22.2	3	8	22	1	4	15.573468	9	9	1	0	1	0.1590173
22.3	4	8	22	1	4	14.8694886	9	9	0	0	1	0.1590173
23	1	8	23	1	7	15.1473792	8	8	1	1	1	1
23.1	2	8	23	1	7	13.6802635	8	8	0	1	1	1
23.2	3	8	23	1	7	15.1473792	8	8	1	0	1	0.31586795
23.3	4	8	23	1	7	13.6802635	8	8	0	0	1	0.31586795
24	1	8	24	1	5	10.6859524	5	5	1	1	1	1
24.1	2	8	24	1	5	8.64403302	5	5	0	1	1	1
24.2	3	8	24	1	5	10.6859524	5	5	1	0	1	2.47564957
24.3	4	8	24	1	5	8.64403302	5	5	0	0	1	2.47564957
25	1	8	25	1	1	15.081579	9	9	1	1	1	1
25.1	2	8	25	1	1	15.0766553	9	9	0	1	1	1
25.2	3	8	25	1	1	15.081579	9	9	1	0	1	0.1590173
25.3	4	8	25	1	1	15.0766553	9	9	0	0	1	0.1590173
26	1	8	26	1	3	13.8017435	8	8	1	1	1	1
26.1	2	8	26	1	3	12.8424025	8	8	0	1	1	1
26.2	3	8	26	1	3	13.8017435	8	8	1	0	1	0.31586795
26.3	4	8	26	1	3	12.8424025	8	8	0	0	1	0.31586795
27	1	8	27	1	9	16.3932829	9	9	1	1	1	1
27.1	2	8	27	1	9	14.5242107	9	9	0	1	1	1
27.2	3	8	27	1	9	16.3932829	9	9	1	0	1	0.1590173
27.3	4	8	27	1	9	14.5242107	9	9	0	0	1	0.1590173
28	1	8	28	0	8	8.96496609	1	0	0	0	0	1
28.1	2	8	28	0	8	10.2650655	1	0	1	0	0	1
28.2	3	8	28	0	8	8.96496609	1	0	0	1	0	0.02594574
28.3	4	8	28	0	8	10.2650655	1	0	1	1	0	0.02594574
29	1	8	29	0	9	12.8241439	5	0	0	0	0	1
29.1	2	8	29	0	9	14.1009395	5	0	1	0	0	1
29.2	3	8	29	0	9	12.8241439	5	0	0	1	0	0.40393439
29.3	4	8	29	0	9	14.1009395	5	0	1	1	0	0.40393439
30	1	8	30	0	9	11.1240771	1	0	0	0	0	1
30.1	2	8	30	0	9	11.8085961	1	0	1	0	0	1
30.2	3	8	30	0	9	11.1240771	1	0	0	1	0	0.02594574
30.3	4	8	30	0	9	11.8085961	1	0	1	1	0	0.02594574
31	1	8	31	0	8	12.4826537	6	0	0	0	0	1
31.1	2	8	31	0	8	13.9927245	6	0	1	0	0	1
31.2	3	8	31	0	8	12.4826537	6	0	0	1	0	0.8023651
31.3	4	8	31	0	8	13.9927245	6	0	1	1	0	0.8023651
32	1	8	32	0	9	11.5490938	2	0	0	0	0	1
32.1	2	8	32	0	9	12.3816819	2	0	1	0	0	1
32.2	3	8	32	0	9	11.5490938	2	0	0	1	0	0.05153796
32.3	4	8	32	0	9	12.3816819	2	0	1	1	0	0.05153796
33	1	8	33	0	9	11.1240771	1	0	0	0	0	1
33.1	2	8	33	0	9	11.8085961	1	0	1	0	0	1
33.2	3	8	33	0	9	11.1240771	1	0	0	1	0	0.02594574
33.3	4	8	33	0	9	11.8085961	1	0	1	1	0	0.02594574
34	1	8	34	0	9	11.9741105	3	0	0	0	0	1
34.1	2	8	34	0	9	12.9547678	3	0	1	0	0	1
34.2	3	8	34	0	9	11.9741105	3	0	0	1	0	0.10237371
34.3	4	8	34	0	9	12.9547678	3	0	1	1	0	0.10237371
35	1	8	35	0	8	13.1861912	7	0	0	0	0	1
35.1	2	8	35	0	8	14.7382563	7	0	1	0	0	1
35.2	3	8	35	0	8	13.1861912	7	0	0	1	0	1.59379783
35.3	4	8	35	0	8	14.7382563	7	0	1	1	0	1.59379783
36	1	8	36	0	6	14.7313774	9	0	0	0	0	1
36.1	2	8	36	0	6	15.901394	9	0	1	0	0	1
36.2	3	8	36	0	6	14.7313774	9	0	0	1	0	6.28862407
36.3	4	8	36	0	6	15.901394	9	0	1	1	0	6.28862407
37	1	8	37	0	7	12.6982052	7	0	0	0	0	1
37.1	2	8	37	0	7	14.2294015	7	0	1	0	0	1
37.2	3	8	37	0	7	12.6982052	7	0	0	1	0	1.59379783
37.3	4	8	37	0	7	14.2294015	7	0	1	1	0	1.59379783
38	1	8	38	0	8	11.7791162	5	0	0	0	0	1
38.1	2	8	38	0	8	13.2471927	5	0	1	0	0	1
38.2	3	8	38	0	8	11.7791162	5	0	0	1	0	0.40393439
38.3	4	8	38	0	8	13.2471927	5	0	1	1	0	0.40393439
39	1	8	39	0	8	10.3720411	3	0	0	0	0	1
39.1	2	8	39	0	8	11.7561291	3	0	1	0	0	1
39.2	3	8	39	0	8	10.3720411	3	0	0	1	0	0.10237371
39.3	4	8	39	0	8	11.7561291	3	0	1	1	0	0.10237371
40	1	8	40	0	7	14.6623218	9	0	0	0	0	1
40.1	2	8	40	0	7	16.0653569	9	0	1	0	0	1
40.2	3	8	40	0	7	14.6623218	9	0	0	1	0	6.28862407
40.3	4	8	40	0	7	16.0653569	9	0	1	1	0	6.28862407
41	1	8	41	0	6	10.9496399	6	0	0	0	0	1
41.1	2	8	41	0	6	12.6301229	6	0	1	0	0	1
41.2	3	8	41	0	6	10.9496399	6	0	0	1	0	0.8023651
41.3	4	8	41	0	6	12.6301229	6	0	1	1	0	0.8023651
42	1	8	42	0	9	11.5490938	2	0	0	0	0	1
42.1	2	8	42	0	9	12.3816819	2	0	1	0	0	1
42.2	3	8	42	0	9	11.5490938	2	0	0	1	0	0.05153796
42.3	4	8	42	0	9	12.3816819	2	0	1	1	0	0.05153796
43	1	8	43	0	9	14.099194	8	0	0	0	0	1
43.1	2	8	43	0	9	15.8201971	8	0	1	0	0	1
43.2	3	8	43	0	9	14.099194	8	0	0	1	0	3.16587988
43.3	4	8	43	0	9	15.8201971	8	0	1	1	0	3.16587988
44	1	8	44	0	3	14.9385441	9	0	0	0	0	1
44.1	2	8	44	0	3	15.409505	9	0	1	0	0	1
44.2	3	8	44	0	3	14.9385441	9	0	0	1	0	6.28862407
44.3	4	8	44	0	3	15.409505	9	0	1	1	0	6.28862407
;
proc print; run;
proc reg; model y=a0 a1 a2 a0a1 a0a2 a1a2 a0a1a2;
run;
proc genmod data=a;
 class id;
 model y=a0 a1 a2 a0a1 a0a2 a1a2 a0a1a2; 
 weight w1;
 repeated subject=id/ type=indep;
 run;
