> ########################
> ###     LGC Model    ###
> ########################
> # Read data
> data <- read.csv("Chap16_ATLASBtoE.csv", na.strings = "*")
> colnames(data) <- c("group", "intent", "nutrit", "sever", "media",
+                     "cintent", "cnutrit", "csever", "cmedia", "dintent", 
+                     "dnutrit","dsever", "dmedia", "eintent", "enutrit", 
+                     "esever", "emedia")
> # Load package
> # install.packages("lavaan")
> library(lavaan)
> 
> # lavaan model string
> model <- '
+   i1 =~ 1*media + 1*cmedia + 1*dmedia + 1*emedia
+   s1 =~ 0*media + 0.3*cmedia + 1*dmedia + 1.3*emedia
+   s3 =~ 0*media + 1*cmedia + 1*dmedia + 1*emedia
+ 
+   i2 =~ 1*nutrit + 1*cnutrit + 1*dnutrit + 1*enutrit
+   s2 =~ 0*nutrit + 0.3*cnutrit + 1*dnutrit + 1.3*enutrit
+   s4 =~ 0*nutrit + 1*cnutrit + 1*dnutrit + 1*enutrit
+ 
+   s1 ~ i2
+   s2 ~ i1 + s3 + group
+   s3 ~ i2 + group
+   s4 ~ s3 + i1 + group
+ 
+   media ~ 0*1
+   cmedia ~ 0*1
+   dmedia ~ 0*1
+   emedia ~ 0*1
+ 
+   nutrit ~ 0*1
+   cnutrit ~ 0*1
+   dnutrit ~ 0*1
+   enutrit ~ 0*1
+ 
+   i1 ~ 1 
+   s1 ~ 1 
+   s3 ~ 1 
+   i2 ~ 1 
+   s2 ~ 1 
+   s4 ~ 1 
+ '
> 
> # Fit model
> fit <- sem(model, data = data, missing = "fiml")
> summary(fit, fit.measures = TRUE, standardized = TRUE)
lavaan 0.6-19 ended normally after 115 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        33

  Number of observations                          1505
  Number of missing patterns                        21

Model Test User Model:
                                                      
  Test statistic                                42.487
  Degrees of freedom                                19
  P-value (Chi-square)                           0.002

Model Test Baseline Model:

  Test statistic                              2038.121
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.988
  Tucker-Lewis Index (TLI)                       0.978
                                                      
  Robust Comparative Fit Index (CFI)             0.988
  Robust Tucker-Lewis Index (TLI)                0.978

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -12035.595
  Loglikelihood unrestricted model (H1)     -12014.352
                                                      
  Akaike (AIC)                               24137.191
  Bayesian (BIC)                             24312.637
  Sample-size adjusted Bayesian (SABIC)      24207.805

Root Mean Square Error of Approximation:

  RMSEA                                          0.029
  90 Percent confidence interval - lower         0.017
  90 Percent confidence interval - upper         0.040
  P-value H_0: RMSEA <= 0.050                    0.999
  P-value H_0: RMSEA >= 0.080                    0.000
                                                      
  Robust RMSEA                                   0.040
  90 Percent confidence interval - lower         0.020
  90 Percent confidence interval - upper         0.059
  P-value H_0: Robust RMSEA <= 0.050             0.801
  P-value H_0: Robust RMSEA >= 0.080             0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.028

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all
  i1 =~                                                                 
    media             1.000                               0.842    0.673
    cmedia            1.000                               0.842    0.646
    dmedia            1.000                               0.842    0.613
    emedia            1.000                               0.842    0.596
  s1 =~                                                                 
    media             0.000                               0.000    0.000
    cmedia            0.300                               0.117    0.090
    dmedia            1.000                               0.390    0.284
    emedia            1.300                               0.507    0.359
  s3 =~                                                                 
    media             0.000                               0.000    0.000
    cmedia            1.000                               0.467    0.358
    dmedia            1.000                               0.467    0.340
    emedia            1.000                               0.467    0.331
  i2 =~                                                                 
    nutrit            1.000                               0.870    0.772
    cnutrit           1.000                               0.870    0.789
    dnutrit           1.000                               0.870    0.750
    enutrit           1.000                               0.870    0.740
  s2 =~                                                                 
    nutrit            0.000                               0.000    0.000
    cnutrit           0.300                               0.185    0.168
    dnutrit           1.000                               0.616    0.531
    enutrit           1.300                               0.800    0.681
  s4 =~                                                                 
    nutrit            0.000                               0.000    0.000
    cnutrit           1.000                               0.633    0.574
    dnutrit           1.000                               0.633    0.545
    enutrit           1.000                               0.633    0.539

Regressions:
                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all
  s1 ~                                                                  
    i2               -0.012    0.078   -0.152    0.880   -0.026   -0.026
  s2 ~                                                                  
    i1               -0.159    0.065   -2.459    0.014   -0.218   -0.218
    s3               -0.224    0.362   -0.620    0.536   -0.170   -0.170
    group            -0.417    0.210   -1.986    0.047   -0.678   -0.338
  s3 ~                                                                  
    i2               -0.128    0.067   -1.903    0.057   -0.238   -0.238
    group            -0.542    0.058   -9.405    0.000   -1.161   -0.579
  s4 ~                                                                  
    s3                0.833    0.429    1.939    0.052    0.614    0.614
    i1               -0.060    0.062   -0.972    0.331   -0.080   -0.080
    group             0.953    0.247    3.855    0.000    1.506    0.751

Covariances:
                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all
  i1 ~~                                                                 
    i2                0.208    0.038    5.520    0.000    0.284    0.284
 .s1 ~~                                                                 
   .s2                0.131    0.057    2.309    0.021    0.581    0.581
   .s4               -0.091    0.059   -1.556    0.120   -0.487   -0.487
 .s2 ~~                                                                 
   .s4               -0.210    0.191   -1.099    0.272   -0.753   -0.753

Intercepts:
                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all
   .media             0.000                               0.000    0.000
   .cmedia            0.000                               0.000    0.000
   .dmedia            0.000                               0.000    0.000
   .emedia            0.000                               0.000    0.000
   .nutrit            0.000                               0.000    0.000
   .cnutrit           0.000                               0.000    0.000
   .dnutrit           0.000                               0.000    0.000
   .enutrit           0.000                               0.000    0.000
    i1                2.766    0.033   84.795    0.000    3.286    3.286
   .s1                0.042    0.314    0.133    0.894    0.107    0.107
   .s3                0.576    0.273    2.110    0.035    1.233    1.233
    i2                3.966    0.029  135.289    0.000    4.558    4.558
   .s2                0.506    0.186    2.725    0.006    0.823    0.823
   .s4                0.114    0.188    0.609    0.543    0.181    0.181

Variances:
                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all
   .media             0.858    0.049   17.605    0.000    0.858    0.548
   .cmedia            0.811    0.055   14.798    0.000    0.811    0.478
   .dmedia            0.866    0.062   13.885    0.000    0.866    0.459
   .emedia            0.867    0.091    9.528    0.000    0.867    0.435
   .nutrit            0.512    0.073    7.044    0.000    0.512    0.404
   .cnutrit           0.375    0.114    3.301    0.001    0.375    0.308
   .dnutrit           0.547    0.042   13.102    0.000    0.547    0.406
   .enutrit           0.484    0.062    7.839    0.000    0.484    0.350
    i1                0.709    0.046   15.349    0.000    1.000    1.000
   .s1                0.152    0.067    2.265    0.024    0.999    0.999
   .s3                0.132    0.059    2.235    0.025    0.608    0.608
    i2                0.757    0.076    9.928    0.000    1.000    1.000
   .s2                0.334    0.178    1.873    0.061    0.881    0.881
   .s4                0.232    0.218    1.067    0.286    0.580    0.580